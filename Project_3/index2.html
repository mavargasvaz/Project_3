<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Drug Deaths Bar Chart</title>
    <!-- Include D3 library -->
    <script src="https://d3js.org/d3.v5.min.js"></script>

    <style>
        /* Add some basic styling for the tooltip */
        .tooltip {
            background-color: #f0f0f0;
            border: 1px solid #999;
            padding: 10px;
            position: absolute;
            opacity: 0;
        }
    </style>
</head>
<body>

<!-- Create a container for the chart -->
<div id="chart-container"></div>

<script>
    // Your CSV data
    const csvData = "./Data/overdose_DB.csv";  // Replace with your actual CSV data

    // Parse CSV data
    const data = d3.csvParse(csvData);

    // Create a color scale for the bars
    const colorScale = d3.scaleSequential(d3.interpolateBlues).domain([0, d3.max(data, d => +d.alldrug_deaths)]);

    // Create an SVG container for the chart
    const svg = d3.select('#chart-container').append('svg')
        .attr('width', 800)
        .attr('height', 400);

    // Create a bar chart
    svg.selectAll('rect')
        .data(data)
        .enter().append('rect')
        .attr('x', (d, i) => i * 80)
        .attr('y', d => 400 - +d.alldrug_deaths)
        .attr('width', 75)
        .attr('height', d => +d.alldrug_deaths)
        .attr('fill', d => colorScale(+d.alldrug_deaths))
        .on('mouseover', handleMouseOver)
        .on('mouseout', handleMouseOut);

    // Create x-axis labels
    svg.selectAll('text')
        .data(data)
        .enter().append('text')
        .attr('x', (d, i) => i * 80 + 37.5)
        .attr('y', 420)
        .attr('text-anchor', 'middle')
        .text(d => d.Jurisdiction);

    // Handle mouseover event for displaying information
    function handleMouseOver(event, d) {
        const tooltip = d3.select('body').append('div')
            .attr('class', 'tooltip')
            .style('position', 'absolute')
            .style('opacity', 0.9);

        tooltip.html(`<strong>${d.Jurisdiction}</strong><br>Deaths: ${d.alldrug_deaths}`)
            .style('left', (event.pageX + 10) + 'px')
            .style('top', (event.pageY - 30) + 'px');
    }

    // Handle mouseout event for hiding the tooltip
    function handleMouseOut() {
        d3.select('.tooltip').remove();
    }
</script>

</body>
</html>
